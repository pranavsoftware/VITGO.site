const _0x455c03=_0x3f0c;(function(_0x5d3213,_0x2acdbd){const _0x154d76=_0x3f0c,_0x5eb7e2=_0x5d3213();while(!![]){try{const _0x544eeb=parseInt(_0x154d76(0x1c0))/0x1*(parseInt(_0x154d76(0x1a7))/0x2)+-parseInt(_0x154d76(0x168))/0x3*(-parseInt(_0x154d76(0x17b))/0x4)+parseInt(_0x154d76(0x1bc))/0x5+-parseInt(_0x154d76(0x1bb))/0x6+-parseInt(_0x154d76(0x1b1))/0x7+parseInt(_0x154d76(0x199))/0x8+-parseInt(_0x154d76(0x172))/0x9;if(_0x544eeb===_0x2acdbd)break;else _0x5eb7e2['push'](_0x5eb7e2['shift']());}catch(_0x38e5cc){_0x5eb7e2['push'](_0x5eb7e2['shift']());}}}(_0x1839,0xc73b4));function _0x1839(){const _0xbc7359=['now','data','toLocaleString','</small>','bell-btn','toLowerCase','sender','appendChild','../Dashboard/dashboard.html','style','messages','1:621065707054:web:8b47875a751d361f2e09bf','1989IWtIVG','querySelector','uid','No\x20Name','signout-btn','history','click','flex','search-bar','toUid','14790933GgzEdD','Please\x20enter\x20a\x20message.','dateTime','pending','easycab-71fcf.firebaseapp.com','stopPropagation','email','createElement','add','3736QNWGQu','getElementById','none','Please\x20select\x20a\x20friend\x20to\x20chat\x20with.','dataset','display','Decline','data-count','message-btn','\x20<br><small>','innerHTML','div','assets/defaultAvatar.jpg','../face/index.html','go-back-btn','trim','forEach','small','span','remove','error','currentUser','li.selected','default\x20Avatar\x20.jpg','Friend\x20request\x20declined','decline-btn','removeAttribute','value','classList','textContent','12371552OQloil','action-btn','notification-content','sent','from','seconds','input','includes','friendRequests','exists','accept-btn','displayName','fromUid','li[data-uid=\x22','2875122rcvIUf','href','Friend\x20request\x20sent','chats','back','size','contains','<strong>','addEventListener','Error\x20sending\x20message:\x20','5374852GfkSjP','Message','message','name',':</strong>\x20','querySelectorAll','all-users-list','getElementsByTagName','Send\x20Friend\x20Request','easycab-71fcf','4007496uMLoKG','1459970pWMLCb','asc','scrollTop','notification-item','1CelTwY','referrer','button','\x20sent\x20you\x20a\x20friend\x20request.','alt','img','selected','Accept','easycab-71fcf.appspot.com','timestamp','accepted','sender-profile-pic','toUid\x20is\x20undefined','block','chat-box','user-profile-pic','reload','target','declined','message-input','src','setAttribute','status','location'];_0x1839=function(){return _0xbc7359;};return _0x1839();}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js';import{getAuth,signOut,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js';import{getFirestore,getDoc,collection,setDoc,query,where,onSnapshot,addDoc,doc,Timestamp,orderBy}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js';const firebaseConfig={'apiKey':'AIzaSyCDD_suBufBLAXzLjV0YPoIq1XU_nOVaBQ','authDomain':_0x455c03(0x176),'projectId':_0x455c03(0x1ba),'storageBucket':_0x455c03(0x1c8),'messagingSenderId':'621065707054','appId':_0x455c03(0x167)},app=initializeApp(firebaseConfig),auth=getAuth(),db=getFirestore(),allUsersList=document[_0x455c03(0x17c)](_0x455c03(0x1b7)),chatBox=document[_0x455c03(0x17c)](_0x455c03(0x152)),messageInput=document[_0x455c03(0x17c)](_0x455c03(0x157)),sendMessageBtn=document[_0x455c03(0x17c)]('send-message-btn'),bellBtn=document['getElementById'](_0x455c03(0x160)),notificationDropdown=document[_0x455c03(0x17c)]('notification-dropdown'),signoutBtn=document[_0x455c03(0x17c)](_0x455c03(0x16c)),searchBar=document[_0x455c03(0x17c)](_0x455c03(0x170)),goBackBtn=document[_0x455c03(0x17c)](_0x455c03(0x189));let currentUserId,currentChatUser;onAuthStateChanged(auth,_0x45c390=>{const _0x45c5ab=_0x455c03;_0x45c390?(currentUserId=_0x45c390['uid'],loadUsers(_0x45c390),loadNotifications(_0x45c390)):window['location'][_0x45c5ab(0x1a8)]=_0x45c5ab(0x188);}),signoutBtn[_0x455c03(0x1af)](_0x455c03(0x16e),async()=>{const _0xe7bca1=_0x455c03;await signOut(auth),window[_0xe7bca1(0x15b)][_0xe7bca1(0x1a8)]='../face/index.html';}),goBackBtn[_0x455c03(0x1af)](_0x455c03(0x16e),()=>{const _0x108a5a=_0x455c03;document[_0x108a5a(0x1c1)]!==''?window[_0x108a5a(0x16d)][_0x108a5a(0x1ab)]():window['location'][_0x108a5a(0x1a8)]=_0x108a5a(0x164);});async function loadUsers(_0xf5ec0b){const _0x4889b3=collection(db,'users');onSnapshot(_0x4889b3,_0x323244=>{const _0x218843=_0x3f0c;allUsersList[_0x218843(0x185)]='',_0x323244[_0x218843(0x18b)](async _0x8ba03=>{const _0x464a40=_0x218843,_0x207a39=_0x8ba03['data']();if(_0x207a39['email']!==_0xf5ec0b[_0x464a40(0x178)]){const _0x5c5b78=document[_0x464a40(0x179)]('li');_0x5c5b78[_0x464a40(0x17f)][_0x464a40(0x16a)]=_0x8ba03['id'];const _0x343498=document[_0x464a40(0x179)](_0x464a40(0x1c5));_0x343498[_0x464a40(0x158)]=_0x207a39['faceScan']||_0x464a40(0x187),_0x343498['alt']=_0x207a39[_0x464a40(0x1b4)]||_0x464a40(0x16b),_0x343498[_0x464a40(0x197)][_0x464a40(0x17a)](_0x464a40(0x153));const _0x7d192d=document[_0x464a40(0x179)](_0x464a40(0x18d));_0x7d192d[_0x464a40(0x198)]=_0x207a39[_0x464a40(0x1b4)]||_0x464a40(0x16b);const _0x30f8fe=document[_0x464a40(0x179)](_0x464a40(0x1c2));_0x30f8fe[_0x464a40(0x198)]=_0x464a40(0x1b9),_0x30f8fe[_0x464a40(0x197)]['add'](_0x464a40(0x19a));const _0x8556f3=doc(db,'friendships',_0xf5ec0b[_0x464a40(0x16a)]+'_'+_0x8ba03['id']),_0x4c786a=await getDoc(_0x8556f3);_0x4c786a['exists']()&&(_0x30f8fe[_0x464a40(0x198)]='Message',_0x30f8fe['classList'][_0x464a40(0x17a)](_0x464a40(0x183))),_0x30f8fe[_0x464a40(0x1af)](_0x464a40(0x16e),async _0x3be952=>{const _0x5c8422=_0x464a40;_0x3be952['stopPropagation'](),_0x4c786a[_0x5c8422(0x1a2)]()?selectFriendForChat(_0x8ba03['id']):await sendFriendRequest(_0xf5ec0b[_0x5c8422(0x16a)],_0x8ba03['id']);}),_0x5c5b78[_0x464a40(0x1af)](_0x464a40(0x16e),()=>{const _0x175ecc=_0x464a40;_0x4c786a[_0x175ecc(0x1a2)]()&&selectFriendForChat(_0x8ba03['id']);}),_0x5c5b78[_0x464a40(0x163)](_0x343498),_0x5c5b78[_0x464a40(0x163)](_0x7d192d),_0x5c5b78['appendChild'](_0x30f8fe),allUsersList[_0x464a40(0x163)](_0x5c5b78);}});});}searchBar[_0x455c03(0x1af)](_0x455c03(0x19f),()=>{const _0x5a0c04=_0x455c03,_0x1e4ec4=searchBar[_0x5a0c04(0x196)][_0x5a0c04(0x161)](),_0x578043=allUsersList[_0x5a0c04(0x1b8)]('li');Array[_0x5a0c04(0x19d)](_0x578043)[_0x5a0c04(0x18b)](_0x2c05f2=>{const _0x19c1e6=_0x5a0c04,_0x4f7e3a=_0x2c05f2[_0x19c1e6(0x169)](_0x19c1e6(0x18d))[_0x19c1e6(0x198)][_0x19c1e6(0x161)]();_0x4f7e3a[_0x19c1e6(0x1a0)](_0x1e4ec4)?_0x2c05f2[_0x19c1e6(0x165)]['display']=_0x19c1e6(0x16f):_0x2c05f2[_0x19c1e6(0x165)]['display']=_0x19c1e6(0x17d);});});async function sendFriendRequest(_0x22cde0,_0xaebad){const _0x46e826=_0x455c03;if(!_0xaebad){console[_0x46e826(0x18f)](_0x46e826(0x1cc));return;}await setDoc(doc(db,'friendRequests',_0x22cde0+'_'+_0xaebad),{'fromUid':_0x22cde0,'toUid':_0xaebad,'status':_0x46e826(0x175),'timestamp':Timestamp['now']()}),alert(_0x46e826(0x1a9));}async function loadNotifications(_0x285433){const _0x34974c=_0x455c03,_0x270393=query(collection(db,_0x34974c(0x1a1)),where('toUid','==',_0x285433[_0x34974c(0x16a)]),where(_0x34974c(0x15a),'==',_0x34974c(0x175)));onSnapshot(_0x270393,_0x41866f=>{const _0x3cd275=_0x34974c,_0x1bfed7=_0x41866f[_0x3cd275(0x1ac)];_0x1bfed7>0x0?bellBtn[_0x3cd275(0x159)](_0x3cd275(0x182),_0x1bfed7):bellBtn[_0x3cd275(0x195)](_0x3cd275(0x182)),notificationDropdown[_0x3cd275(0x185)]='',_0x41866f[_0x3cd275(0x18b)](async _0x463ae0=>{const _0x2823bb=_0x3cd275,_0x2b23c0=_0x463ae0['data'](),_0x129b6a=await getDoc(doc(db,'users',_0x2b23c0[_0x2823bb(0x1a5)])),_0xf3f114=_0x129b6a[_0x2823bb(0x15d)](),_0x312ff9=document[_0x2823bb(0x179)](_0x2823bb(0x186));_0x312ff9[_0x2823bb(0x197)][_0x2823bb(0x17a)](_0x2823bb(0x1bf));const _0x4be942=document[_0x2823bb(0x179)](_0x2823bb(0x1c5));_0x4be942[_0x2823bb(0x158)]=_0xf3f114['photoURL']||_0x2823bb(0x192),_0x4be942[_0x2823bb(0x1c4)]=_0xf3f114[_0x2823bb(0x1a4)],_0x4be942['classList'][_0x2823bb(0x17a)](_0x2823bb(0x1cb));const _0x211f6b=document['createElement'](_0x2823bb(0x186));_0x211f6b[_0x2823bb(0x197)][_0x2823bb(0x17a)](_0x2823bb(0x19b));const _0x395d60=document['createElement'](_0x2823bb(0x18d));_0x395d60[_0x2823bb(0x198)]=_0xf3f114['displayName'];const _0x18bc51=document['createElement'](_0x2823bb(0x18d));_0x18bc51[_0x2823bb(0x198)]=_0x2823bb(0x1c3);const _0x4e8993=_0x2b23c0[_0x2823bb(0x1c9)]?new Date(_0x2b23c0['timestamp'][_0x2823bb(0x19e)]*0x3e8)[_0x2823bb(0x15e)]():'',_0x8c3dfb=document[_0x2823bb(0x179)](_0x2823bb(0x18c));_0x8c3dfb[_0x2823bb(0x198)]=_0x4e8993,_0x211f6b[_0x2823bb(0x163)](_0x395d60),_0x211f6b[_0x2823bb(0x163)](_0x18bc51),_0x211f6b[_0x2823bb(0x163)](document[_0x2823bb(0x179)]('br')),_0x211f6b['appendChild'](_0x8c3dfb);const _0x2cce0a=document['createElement'](_0x2823bb(0x1c2));_0x2cce0a[_0x2823bb(0x198)]=_0x2823bb(0x1c7),_0x2cce0a[_0x2823bb(0x197)][_0x2823bb(0x17a)](_0x2823bb(0x1a3)),_0x2cce0a[_0x2823bb(0x1af)](_0x2823bb(0x16e),_0x283f20=>{const _0x33e102=_0x2823bb;_0x283f20[_0x33e102(0x177)](),acceptFriendRequest(_0x2b23c0);});const _0x26fa92=document[_0x2823bb(0x179)](_0x2823bb(0x1c2));_0x26fa92[_0x2823bb(0x198)]=_0x2823bb(0x181),_0x26fa92[_0x2823bb(0x197)]['add'](_0x2823bb(0x194)),_0x26fa92[_0x2823bb(0x1af)](_0x2823bb(0x16e),_0x5e5802=>{_0x5e5802['stopPropagation'](),declineFriendRequest(_0x2b23c0);}),_0x312ff9['appendChild'](_0x4be942),_0x312ff9[_0x2823bb(0x163)](_0x211f6b),_0x312ff9['appendChild'](_0x2cce0a),_0x312ff9[_0x2823bb(0x163)](_0x26fa92),notificationDropdown['appendChild'](_0x312ff9);});});}async function acceptFriendRequest(_0x2939e7){const _0x11f4cf=_0x455c03;await setDoc(doc(db,'friendships',_0x2939e7['fromUid']+'_'+_0x2939e7[_0x11f4cf(0x171)]),{'users':[_0x2939e7[_0x11f4cf(0x1a5)],_0x2939e7[_0x11f4cf(0x171)]],'status':'accepted','timestamp':Timestamp[_0x11f4cf(0x15c)]()}),await setDoc(doc(db,_0x11f4cf(0x1a1),_0x2939e7[_0x11f4cf(0x1a5)]+'_'+_0x2939e7[_0x11f4cf(0x171)]),{..._0x2939e7,'status':_0x11f4cf(0x1ca),'acceptedAt':Timestamp[_0x11f4cf(0x15c)]()});const _0xbd0385=allUsersList[_0x11f4cf(0x169)](_0x11f4cf(0x1a6)+_0x2939e7[_0x11f4cf(0x1a5)]+'\x22]');if(_0xbd0385){const _0x2ad4d9=_0xbd0385[_0x11f4cf(0x169)](_0x11f4cf(0x1c2));_0x2ad4d9[_0x11f4cf(0x198)]=_0x11f4cf(0x1b2),_0x2ad4d9['classList'][_0x11f4cf(0x17a)]('message-btn');}alert('Friend\x20request\x20accepted'),location[_0x11f4cf(0x154)]();}async function declineFriendRequest(_0x455671){const _0x4edfad=_0x455c03;await setDoc(doc(db,_0x4edfad(0x1a1),_0x455671[_0x4edfad(0x1a5)]+'_'+_0x455671[_0x4edfad(0x171)]),{..._0x455671,'status':_0x4edfad(0x156),'declinedAt':Timestamp[_0x4edfad(0x15c)]()}),loadNotifications(auth['currentUser']),alert(_0x4edfad(0x193)),location[_0x4edfad(0x154)]();}function selectFriendForChat(_0xce0e97){const _0x12b73f=_0x455c03;currentChatUser=_0xce0e97;const _0x2f8ff0=allUsersList[_0x12b73f(0x169)]('li[data-uid=\x22'+_0xce0e97+'\x22]');allUsersList[_0x12b73f(0x1b6)]('li')['forEach'](_0x4b23c7=>_0x4b23c7['classList'][_0x12b73f(0x18e)](_0x12b73f(0x1c6))),_0x2f8ff0&&_0x2f8ff0['classList'][_0x12b73f(0x17a)](_0x12b73f(0x1c6)),loadChat(auth[_0x12b73f(0x190)][_0x12b73f(0x16a)],_0xce0e97);}async function loadChat(_0x16177c,_0x358a7c){const _0x17d752=_0x455c03,_0x120d06=_0x16177c>_0x358a7c?_0x16177c+'_'+_0x358a7c:_0x358a7c+'_'+_0x16177c,_0x1b9877=query(collection(db,'chats',_0x120d06,_0x17d752(0x166)),orderBy(_0x17d752(0x174),_0x17d752(0x1bd)));chatBox[_0x17d752(0x185)]='',onSnapshot(_0x1b9877,_0x218fd0=>{const _0x28c988=_0x17d752;chatBox[_0x28c988(0x185)]='',_0x218fd0[_0x28c988(0x18b)](_0x2e6dbe=>{const _0x5c2a52=_0x28c988,_0x14b693=_0x2e6dbe[_0x5c2a52(0x15d)](),_0x1fe7ad=document[_0x5c2a52(0x179)](_0x5c2a52(0x186));_0x1fe7ad[_0x5c2a52(0x197)][_0x5c2a52(0x17a)](_0x5c2a52(0x1b3));const _0x284b51=new Date(_0x14b693[_0x5c2a52(0x174)]['seconds']*0x3e8),_0x14c437=_0x284b51[_0x5c2a52(0x15e)]();_0x14b693[_0x5c2a52(0x162)]===auth[_0x5c2a52(0x190)]['displayName']?(_0x1fe7ad[_0x5c2a52(0x197)]['add'](_0x5c2a52(0x19c)),_0x1fe7ad[_0x5c2a52(0x185)]='<strong>You:</strong>\x20'+_0x14b693['message']+_0x5c2a52(0x184)+_0x14c437+_0x5c2a52(0x15f)):(_0x1fe7ad[_0x5c2a52(0x197)][_0x5c2a52(0x17a)]('received'),_0x1fe7ad['innerHTML']=_0x5c2a52(0x1ae)+_0x14b693[_0x5c2a52(0x162)]+_0x5c2a52(0x1b5)+_0x14b693[_0x5c2a52(0x1b3)]+_0x5c2a52(0x184)+_0x14c437+_0x5c2a52(0x15f)),chatBox['appendChild'](_0x1fe7ad);}),chatBox[_0x28c988(0x1be)]=chatBox['scrollHeight'];});}function _0x3f0c(_0x4ecccc,_0x269b9d){const _0x1839c9=_0x1839();return _0x3f0c=function(_0x3f0c42,_0x4bb3bf){_0x3f0c42=_0x3f0c42-0x152;let _0x3ba884=_0x1839c9[_0x3f0c42];return _0x3ba884;},_0x3f0c(_0x4ecccc,_0x269b9d);}sendMessageBtn[_0x455c03(0x1af)](_0x455c03(0x16e),async()=>{const _0x19d6dc=_0x455c03,_0x2a4717=messageInput[_0x19d6dc(0x196)][_0x19d6dc(0x18a)](),_0x2eded0=allUsersList[_0x19d6dc(0x169)](_0x19d6dc(0x191)),_0x9c0fa1=_0x2eded0?_0x2eded0[_0x19d6dc(0x17f)]['uid']:null;if(!_0x9c0fa1){alert(_0x19d6dc(0x17e));return;}if(!_0x2a4717){alert(_0x19d6dc(0x173));return;}const _0x506d23=auth['currentUser'][_0x19d6dc(0x16a)]>_0x9c0fa1?auth['currentUser']['uid']+'_'+_0x9c0fa1:_0x9c0fa1+'_'+auth['currentUser'][_0x19d6dc(0x16a)];try{await addDoc(collection(db,_0x19d6dc(0x1aa),_0x506d23,'messages'),{'sender':auth[_0x19d6dc(0x190)][_0x19d6dc(0x1a4)],'message':_0x2a4717,'dateTime':Timestamp[_0x19d6dc(0x15c)]()}),messageInput['value']='';}catch(_0x1bf1ad){console[_0x19d6dc(0x18f)](_0x19d6dc(0x1b0),_0x1bf1ad);}}),bellBtn[_0x455c03(0x1af)]('click',_0x1d411e=>{const _0xef7713=_0x455c03;_0x1d411e[_0xef7713(0x177)](),notificationDropdown[_0xef7713(0x165)][_0xef7713(0x180)]===_0xef7713(0x1cd)?notificationDropdown[_0xef7713(0x165)]['display']=_0xef7713(0x17d):notificationDropdown['style']['display']=_0xef7713(0x1cd);}),window['addEventListener'](_0x455c03(0x16e),_0x156697=>{const _0xd9233a=_0x455c03;!notificationDropdown[_0xd9233a(0x1ad)](_0x156697[_0xd9233a(0x155)])&&!bellBtn['contains'](_0x156697[_0xd9233a(0x155)])&&(notificationDropdown[_0xd9233a(0x165)][_0xd9233a(0x180)]=_0xd9233a(0x17d));});
