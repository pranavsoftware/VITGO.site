function _0x5782(_0x2dacab,_0x50731a){const _0x3d559b=_0x3d55();return _0x5782=function(_0x57824a,_0x58c158){_0x57824a=_0x57824a-0x1d0;let _0x1c72e6=_0x3d559b[_0x57824a];return _0x1c72e6;},_0x5782(_0x2dacab,_0x50731a);}const _0x268bc6=_0x5782;(function(_0x15cbba,_0x34008d){const _0x3bc3f1=_0x5782,_0x52b645=_0x15cbba();while(!![]){try{const _0x31c94e=parseInt(_0x3bc3f1(0x227))/0x1*(-parseInt(_0x3bc3f1(0x210))/0x2)+-parseInt(_0x3bc3f1(0x20a))/0x3*(parseInt(_0x3bc3f1(0x211))/0x4)+parseInt(_0x3bc3f1(0x208))/0x5+-parseInt(_0x3bc3f1(0x228))/0x6+-parseInt(_0x3bc3f1(0x218))/0x7*(-parseInt(_0x3bc3f1(0x1dc))/0x8)+parseInt(_0x3bc3f1(0x23f))/0x9*(parseInt(_0x3bc3f1(0x203))/0xa)+parseInt(_0x3bc3f1(0x23b))/0xb*(parseInt(_0x3bc3f1(0x1f1))/0xc);if(_0x31c94e===_0x34008d)break;else _0x52b645['push'](_0x52b645['shift']());}catch(_0x2ca63c){_0x52b645['push'](_0x52b645['shift']());}}}(_0x3d55,0xdc2d1));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js';import{getAuth,signOut,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js';function _0x3d55(){const _0x11a918=['15vlupsW','name','span','small','Send\x20Friend\x20Request','\x20sent\x20you\x20a\x20friend\x20request.','156726utrYqt','1283836sJWfsw','img','href','easycab-71fcf','user-profile-pic','getElementById','appendChild','7LXOfqH','users','style','seconds','message-input','Accept','fromUid','includes',':</strong>\x20','toLocaleString','dateTime','pending','sender','data','declined','4tTeggB','8901288HSPcfu','go-back-btn','toLowerCase','addEventListener','Friend\x20request\x20accepted','contains','chat-box','</small>','../face/index.html','click','accept-btn','Error\x20sending\x20message:\x20','dataset','toUid','sent','Message','querySelector','button','AIzaSyCDD_suBufBLAXzLjV0YPoIq1XU_nOVaBQ','154UFijyg','scrollHeight','flex','alt','3335994MDVxfZ','\x20<br><small>','setAttribute','chats','<strong>You:</strong>\x20','621065707054','../assets/default\x20Avatar\x20.jpg','messages','innerHTML','textContent','send-message-btn','value','li.selected','decline-btn','none','location','<strong>','forEach','error','add','referrer','notification-item','status','No\x20Name','reload','7288360yBJbGN','from','action-btn','message-btn','displayName','removeAttribute','email','all-users-list','bell-btn','faceScan','display','input','now','size','Friend\x20request\x20sent','data-count','li[data-uid=\x22','timestamp','notification-dropdown','notification-content','remove','886368mFhyHu','classList','src','div','createElement','Decline','friendRequests','1:621065707054:web:8b47875a751d361f2e09bf','trim','block','message','friendships','stopPropagation','uid','back','exists','target','currentUser','30VHtuXP','accepted','scrollTop','../Dashboard/dashboard.html','search-bar','6232485kBqpNT','Please\x20enter\x20a\x20message.'];_0x3d55=function(){return _0x11a918;};return _0x3d55();}import{getFirestore,getDoc,collection,setDoc,query,where,onSnapshot,addDoc,doc,Timestamp,orderBy}from'https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js';const firebaseConfig={'apiKey':_0x268bc6(0x23a),'authDomain':'easycab-71fcf.firebaseapp.com','projectId':_0x268bc6(0x214),'storageBucket':'easycab-71fcf.appspot.com','messagingSenderId':_0x268bc6(0x244),'appId':_0x268bc6(0x1f8)},app=initializeApp(firebaseConfig),auth=getAuth(),db=getFirestore(),allUsersList=document[_0x268bc6(0x216)](_0x268bc6(0x1e3)),chatBox=document[_0x268bc6(0x216)](_0x268bc6(0x22e)),messageInput=document[_0x268bc6(0x216)](_0x268bc6(0x21c)),sendMessageBtn=document[_0x268bc6(0x216)](_0x268bc6(0x249)),bellBtn=document[_0x268bc6(0x216)](_0x268bc6(0x1e4)),notificationDropdown=document[_0x268bc6(0x216)](_0x268bc6(0x1ee)),signoutBtn=document[_0x268bc6(0x216)]('signout-btn'),searchBar=document[_0x268bc6(0x216)](_0x268bc6(0x207)),goBackBtn=document[_0x268bc6(0x216)](_0x268bc6(0x229));let currentUserId,currentChatUser;onAuthStateChanged(auth,_0xe1d2a0=>{const _0x36bba8=_0x268bc6;_0xe1d2a0?(currentUserId=_0xe1d2a0[_0x36bba8(0x1fe)],loadUsers(_0xe1d2a0),loadNotifications(_0xe1d2a0)):window[_0x36bba8(0x1d2)][_0x36bba8(0x213)]=_0x36bba8(0x230);}),signoutBtn[_0x268bc6(0x22b)]('click',async()=>{const _0x209728=_0x268bc6;await signOut(auth),window[_0x209728(0x1d2)][_0x209728(0x213)]=_0x209728(0x230);}),goBackBtn[_0x268bc6(0x22b)](_0x268bc6(0x231),()=>{const _0x1eeb04=_0x268bc6;document[_0x1eeb04(0x1d7)]!==''?window['history'][_0x1eeb04(0x1ff)]():window[_0x1eeb04(0x1d2)][_0x1eeb04(0x213)]=_0x1eeb04(0x206);});async function loadUsers(_0x1f2daf){const _0x2a6389=collection(db,'users');onSnapshot(_0x2a6389,_0x241c0c=>{const _0xdcc6a7=_0x5782;allUsersList[_0xdcc6a7(0x247)]='',_0x241c0c[_0xdcc6a7(0x1d4)](async _0xcd54f1=>{const _0x56527e=_0xdcc6a7,_0x611f90=_0xcd54f1[_0x56527e(0x225)]();if(_0x611f90[_0x56527e(0x1e2)]!==_0x1f2daf['email']){const _0x59ca57=document[_0x56527e(0x1f5)]('li');_0x59ca57[_0x56527e(0x234)][_0x56527e(0x1fe)]=_0xcd54f1['id'];const _0x264113=document[_0x56527e(0x1f5)](_0x56527e(0x212));_0x264113[_0x56527e(0x1f3)]=_0x611f90[_0x56527e(0x1e5)]||_0x56527e(0x245),_0x264113[_0x56527e(0x23e)]=_0x611f90[_0x56527e(0x20b)]||_0x56527e(0x1da),_0x264113[_0x56527e(0x1f2)][_0x56527e(0x1d6)]('user-profile-pic');const _0xb07d6f=document[_0x56527e(0x1f5)](_0x56527e(0x20c));_0xb07d6f['textContent']=_0x611f90[_0x56527e(0x20b)]||_0x56527e(0x1da);const _0x5df1a9=document[_0x56527e(0x1f5)]('button');_0x5df1a9[_0x56527e(0x248)]=_0x56527e(0x20e),_0x5df1a9[_0x56527e(0x1f2)][_0x56527e(0x1d6)](_0x56527e(0x1de));const _0xfd5362=doc(db,_0x56527e(0x1fc),_0x1f2daf[_0x56527e(0x1fe)]+'_'+_0xcd54f1['id']),_0x4691d0=await getDoc(_0xfd5362);_0x4691d0[_0x56527e(0x200)]()&&(_0x5df1a9[_0x56527e(0x248)]=_0x56527e(0x237),_0x5df1a9['classList'][_0x56527e(0x1d6)](_0x56527e(0x1df))),_0x5df1a9['addEventListener']('click',async _0x59728e=>{const _0x32df1b=_0x56527e;_0x59728e[_0x32df1b(0x1fd)](),_0x4691d0[_0x32df1b(0x200)]()?selectFriendForChat(_0xcd54f1['id']):await sendFriendRequest(_0x1f2daf['uid'],_0xcd54f1['id']);}),_0x59ca57['addEventListener'](_0x56527e(0x231),()=>{_0x4691d0['exists']()&&selectFriendForChat(_0xcd54f1['id']);}),_0x59ca57[_0x56527e(0x217)](_0x264113),_0x59ca57[_0x56527e(0x217)](_0xb07d6f),_0x59ca57[_0x56527e(0x217)](_0x5df1a9),allUsersList['appendChild'](_0x59ca57);}});});}searchBar[_0x268bc6(0x22b)](_0x268bc6(0x1e7),()=>{const _0x3ab419=_0x268bc6,_0x32226c=searchBar[_0x3ab419(0x24a)]['toLowerCase'](),_0x160cb5=allUsersList['getElementsByTagName']('li');Array[_0x3ab419(0x1dd)](_0x160cb5)[_0x3ab419(0x1d4)](_0x54ca67=>{const _0x71d073=_0x3ab419,_0x54174e=_0x54ca67[_0x71d073(0x238)](_0x71d073(0x20c))[_0x71d073(0x248)][_0x71d073(0x22a)]();_0x54174e[_0x71d073(0x21f)](_0x32226c)?_0x54ca67[_0x71d073(0x21a)]['display']=_0x71d073(0x23d):_0x54ca67[_0x71d073(0x21a)]['display']=_0x71d073(0x1d1);});});async function sendFriendRequest(_0x249109,_0x40ae85){const _0x2d3cf4=_0x268bc6;if(!_0x40ae85){console[_0x2d3cf4(0x1d5)]('toUid\x20is\x20undefined');return;}await setDoc(doc(db,_0x2d3cf4(0x1f7),_0x249109+'_'+_0x40ae85),{'fromUid':_0x249109,'toUid':_0x40ae85,'status':_0x2d3cf4(0x223),'timestamp':Timestamp[_0x2d3cf4(0x1e8)]()}),alert(_0x2d3cf4(0x1ea));}async function loadNotifications(_0x2b5712){const _0x6b2ce1=_0x268bc6,_0x4e02aa=query(collection(db,'friendRequests'),where(_0x6b2ce1(0x235),'==',_0x2b5712[_0x6b2ce1(0x1fe)]),where(_0x6b2ce1(0x1d9),'==',_0x6b2ce1(0x223)));onSnapshot(_0x4e02aa,_0x2eea22=>{const _0x3b5860=_0x6b2ce1,_0xed266f=_0x2eea22[_0x3b5860(0x1e9)];_0xed266f>0x0?bellBtn[_0x3b5860(0x241)](_0x3b5860(0x1eb),_0xed266f):bellBtn[_0x3b5860(0x1e1)]('data-count'),notificationDropdown[_0x3b5860(0x247)]='',_0x2eea22[_0x3b5860(0x1d4)](async _0x3182d4=>{const _0x554628=_0x3b5860,_0x7b6c88=_0x3182d4[_0x554628(0x225)](),_0x54d5f7=await getDoc(doc(db,_0x554628(0x219),_0x7b6c88[_0x554628(0x21e)])),_0x309d95=_0x54d5f7[_0x554628(0x225)](),_0x1c9439=document[_0x554628(0x1f5)](_0x554628(0x1f4));_0x1c9439[_0x554628(0x1f2)][_0x554628(0x1d6)](_0x554628(0x1d8));const _0x431ca7=document[_0x554628(0x1f5)](_0x554628(0x212));_0x431ca7[_0x554628(0x1f3)]=_0x309d95[_0x554628(0x1e5)]||_0x554628(0x245),_0x431ca7[_0x554628(0x23e)]=_0x309d95[_0x554628(0x20b)],_0x431ca7[_0x554628(0x1f2)][_0x554628(0x1d6)](_0x554628(0x215));const _0x11ca07=document['createElement']('div');_0x11ca07[_0x554628(0x1f2)][_0x554628(0x1d6)](_0x554628(0x1ef));const _0x5af9ed=document[_0x554628(0x1f5)](_0x554628(0x20c));_0x5af9ed[_0x554628(0x248)]=_0x309d95['name'];const _0x4e9445=document['createElement']('span');_0x4e9445[_0x554628(0x248)]=_0x554628(0x20f);const _0x20cfbe=_0x7b6c88['timestamp']?new Date(_0x7b6c88[_0x554628(0x1ed)][_0x554628(0x21b)]*0x3e8)['toLocaleString']():'',_0xe8f428=document[_0x554628(0x1f5)](_0x554628(0x20d));_0xe8f428[_0x554628(0x248)]=_0x20cfbe,_0x11ca07[_0x554628(0x217)](_0x5af9ed),_0x11ca07['appendChild'](_0x4e9445),_0x11ca07[_0x554628(0x217)](document[_0x554628(0x1f5)]('br')),_0x11ca07[_0x554628(0x217)](_0xe8f428);const _0x1b710f=document[_0x554628(0x1f5)](_0x554628(0x239));_0x1b710f[_0x554628(0x248)]=_0x554628(0x21d),_0x1b710f[_0x554628(0x1f2)][_0x554628(0x1d6)](_0x554628(0x232)),_0x1b710f[_0x554628(0x22b)](_0x554628(0x231),_0xce109a=>{_0xce109a['stopPropagation'](),acceptFriendRequest(_0x7b6c88);});const _0x4b8f93=document['createElement']('button');_0x4b8f93[_0x554628(0x248)]=_0x554628(0x1f6),_0x4b8f93[_0x554628(0x1f2)]['add'](_0x554628(0x1d0)),_0x4b8f93['addEventListener'](_0x554628(0x231),_0x5c4220=>{_0x5c4220['stopPropagation'](),declineFriendRequest(_0x7b6c88);}),_0x1c9439['appendChild'](_0x431ca7),_0x1c9439['appendChild'](_0x11ca07),_0x1c9439[_0x554628(0x217)](_0x1b710f),_0x1c9439[_0x554628(0x217)](_0x4b8f93),notificationDropdown[_0x554628(0x217)](_0x1c9439);});});}async function acceptFriendRequest(_0x3c9bdc){const _0x43da3d=_0x268bc6;await setDoc(doc(db,_0x43da3d(0x1fc),_0x3c9bdc[_0x43da3d(0x21e)]+'_'+_0x3c9bdc[_0x43da3d(0x235)]),{'users':[_0x3c9bdc['fromUid'],_0x3c9bdc[_0x43da3d(0x235)]],'status':_0x43da3d(0x204),'timestamp':Timestamp[_0x43da3d(0x1e8)]()}),await setDoc(doc(db,_0x43da3d(0x1f7),_0x3c9bdc[_0x43da3d(0x21e)]+'_'+_0x3c9bdc[_0x43da3d(0x235)]),{..._0x3c9bdc,'status':_0x43da3d(0x204),'acceptedAt':Timestamp['now']()});const _0x1b60e2=allUsersList[_0x43da3d(0x238)](_0x43da3d(0x1ec)+_0x3c9bdc[_0x43da3d(0x21e)]+'\x22]');if(_0x1b60e2){const _0x37f80a=_0x1b60e2[_0x43da3d(0x238)](_0x43da3d(0x239));_0x37f80a[_0x43da3d(0x248)]='Message',_0x37f80a[_0x43da3d(0x1f2)][_0x43da3d(0x1d6)](_0x43da3d(0x1df));}alert(_0x43da3d(0x22c)),location[_0x43da3d(0x1db)]();}async function declineFriendRequest(_0x5745a8){const _0x3a92a1=_0x268bc6;await setDoc(doc(db,_0x3a92a1(0x1f7),_0x5745a8[_0x3a92a1(0x21e)]+'_'+_0x5745a8[_0x3a92a1(0x235)]),{..._0x5745a8,'status':_0x3a92a1(0x226),'declinedAt':Timestamp[_0x3a92a1(0x1e8)]()}),loadNotifications(auth[_0x3a92a1(0x202)]),alert('Friend\x20request\x20declined'),location['reload']();}function selectFriendForChat(_0x396278){const _0x3f1e2b=_0x268bc6;currentChatUser=_0x396278;const _0x5e91e5=allUsersList['querySelector']('li[data-uid=\x22'+_0x396278+'\x22]');allUsersList['querySelectorAll']('li')[_0x3f1e2b(0x1d4)](_0x2313c6=>_0x2313c6[_0x3f1e2b(0x1f2)][_0x3f1e2b(0x1f0)]('selected')),_0x5e91e5&&_0x5e91e5[_0x3f1e2b(0x1f2)][_0x3f1e2b(0x1d6)]('selected'),loadChat(auth[_0x3f1e2b(0x202)][_0x3f1e2b(0x1fe)],_0x396278);}async function loadChat(_0x313332,_0x25d9d7){const _0x4c20bc=_0x268bc6,_0xa0befe=_0x313332>_0x25d9d7?_0x313332+'_'+_0x25d9d7:_0x25d9d7+'_'+_0x313332,_0x17c5f3=query(collection(db,_0x4c20bc(0x242),_0xa0befe,_0x4c20bc(0x246)),orderBy(_0x4c20bc(0x222),'asc'));chatBox[_0x4c20bc(0x247)]='',onSnapshot(_0x17c5f3,_0x4db693=>{const _0x3246f0=_0x4c20bc;chatBox['innerHTML']='',_0x4db693[_0x3246f0(0x1d4)](_0x377354=>{const _0x2ba837=_0x3246f0,_0x4a278b=_0x377354[_0x2ba837(0x225)](),_0x57b293=document[_0x2ba837(0x1f5)](_0x2ba837(0x1f4));_0x57b293[_0x2ba837(0x1f2)][_0x2ba837(0x1d6)](_0x2ba837(0x1fb));const _0x5b85c7=new Date(_0x4a278b[_0x2ba837(0x222)]['seconds']*0x3e8),_0x48e72e=_0x5b85c7[_0x2ba837(0x221)]();_0x4a278b[_0x2ba837(0x224)]===auth[_0x2ba837(0x202)][_0x2ba837(0x1e0)]?(_0x57b293[_0x2ba837(0x1f2)][_0x2ba837(0x1d6)](_0x2ba837(0x236)),_0x57b293[_0x2ba837(0x247)]=_0x2ba837(0x243)+_0x4a278b[_0x2ba837(0x1fb)]+'\x20<br><small>'+_0x48e72e+_0x2ba837(0x22f)):(_0x57b293[_0x2ba837(0x1f2)][_0x2ba837(0x1d6)]('received'),_0x57b293[_0x2ba837(0x247)]=_0x2ba837(0x1d3)+_0x4a278b[_0x2ba837(0x224)]+_0x2ba837(0x220)+_0x4a278b[_0x2ba837(0x1fb)]+_0x2ba837(0x240)+_0x48e72e+_0x2ba837(0x22f)),chatBox[_0x2ba837(0x217)](_0x57b293);}),chatBox[_0x3246f0(0x205)]=chatBox[_0x3246f0(0x23c)];});}sendMessageBtn[_0x268bc6(0x22b)](_0x268bc6(0x231),async()=>{const _0x3df71c=_0x268bc6,_0x34e4a=messageInput[_0x3df71c(0x24a)][_0x3df71c(0x1f9)](),_0x5521e2=allUsersList[_0x3df71c(0x238)](_0x3df71c(0x24b)),_0x54c963=_0x5521e2?_0x5521e2['dataset'][_0x3df71c(0x1fe)]:null;if(!_0x54c963){alert('Please\x20select\x20a\x20friend\x20to\x20chat\x20with.');return;}if(!_0x34e4a){alert(_0x3df71c(0x209));return;}const _0xe6406a=auth[_0x3df71c(0x202)][_0x3df71c(0x1fe)]>_0x54c963?auth['currentUser'][_0x3df71c(0x1fe)]+'_'+_0x54c963:_0x54c963+'_'+auth[_0x3df71c(0x202)][_0x3df71c(0x1fe)];try{await addDoc(collection(db,_0x3df71c(0x242),_0xe6406a,_0x3df71c(0x246)),{'sender':auth[_0x3df71c(0x202)][_0x3df71c(0x1e0)],'message':_0x34e4a,'dateTime':Timestamp[_0x3df71c(0x1e8)]()}),messageInput['value']='';}catch(_0x3fc392){console['error'](_0x3df71c(0x233),_0x3fc392);}}),bellBtn[_0x268bc6(0x22b)]('click',_0x8031f1=>{const _0x5d82f7=_0x268bc6;_0x8031f1['stopPropagation'](),notificationDropdown[_0x5d82f7(0x21a)]['display']===_0x5d82f7(0x1fa)?notificationDropdown[_0x5d82f7(0x21a)][_0x5d82f7(0x1e6)]=_0x5d82f7(0x1d1):notificationDropdown[_0x5d82f7(0x21a)][_0x5d82f7(0x1e6)]='block';}),window[_0x268bc6(0x22b)](_0x268bc6(0x231),_0x339b5f=>{const _0x2608cf=_0x268bc6;!notificationDropdown[_0x2608cf(0x22d)](_0x339b5f[_0x2608cf(0x201)])&&!bellBtn[_0x2608cf(0x22d)](_0x339b5f[_0x2608cf(0x201)])&&(notificationDropdown[_0x2608cf(0x21a)][_0x2608cf(0x1e6)]=_0x2608cf(0x1d1));});
